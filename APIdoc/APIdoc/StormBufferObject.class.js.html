<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>StormEngineC 1.2 API DOC Source: StormBufferObject.class.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.stormenginec.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">StormEngineC 1.2 API DOC</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="StormBufferObject.html">StormBufferObject</a>
						</li>
						
						<li>
							<a href="StormCamera.html">StormCamera</a>
						</li>
						
						<li>
							<a href="StormEngineC.html">StormEngineC</a>
						</li>
						
						<li>
							<a href="StormEngineC_PanelAnimationTimeline.html">StormEngineC_PanelAnimationTimeline</a>
						</li>
						
						<li>
							<a href="StormForceField.html">StormForceField</a>
						</li>
						
						<li>
							<a href="StormGI.html">StormGI</a>
						</li>
						
						<li>
							<a href="StormGLContext.html">StormGLContext</a>
						</li>
						
						<li>
							<a href="StormGroupNodes.html">StormGroupNodes</a>
						</li>
						
						<li>
							<a href="StormLight.html">StormLight</a>
						</li>
						
						<li>
							<a href="StormLine.html">StormLine</a>
						</li>
						
						<li>
							<a href="StormLineSceneCollision.html">StormLineSceneCollision</a>
						</li>
						
						<li>
							<a href="StormM16.html">StormM16</a>
						</li>
						
						<li>
							<a href="StormMaterial.html">StormMaterial</a>
						</li>
						
						<li>
							<a href="StormNode.html">StormNode</a>
						</li>
						
						<li>
							<a href="StormParticles.html">StormParticles</a>
						</li>
						
						<li>
							<a href="StormPolarityPoint.html">StormPolarityPoint</a>
						</li>
						
						<li>
							<a href="StormTriangleBox.html">StormTriangleBox</a>
						</li>
						
						<li>
							<a href="StormUtils.html">StormUtils</a>
						</li>
						
						<li>
							<a href="StormV3.html">StormV3</a>
						</li>
						
						<li>
							<a href="StormVoxelizator.html">StormVoxelizator</a>
						</li>
						
						<li>
							<a href="WebCLGL.html">WebCLGL</a>
						</li>
						
						<li>
							<a href="WebCLGLBuffer.html">WebCLGLBuffer</a>
						</li>
						
						<li>
							<a href="WebCLGLKernel.html">WebCLGLKernel</a>
						</li>
						
						<li>
							<a href="WebCLGLUtils.html">WebCLGLUtils</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#$M16">$M16</a>
						</li>
						
						<li>
							<a href="global.html#$V3">$V3</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: StormBufferObject.class.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">/**
* @class
* @constructor

* @property {WebGLBuffer} nodeMeshVertexBuffer
* @property {WebGLBuffer} nodeMeshNormalBuffer
* @property {WebGLBuffer} nodeMeshTextureBuffer
* @property {WebGLBuffer} nodeMeshIndexBuffer

* @property {Array} nodeMeshVertexArray
* @property {Int} nodeMeshVertexArrayItemSize
* @property {Int} nodeMeshVertexArrayNumItems

* @property {Array} nodeMeshNormalArray
* @property {Int} nodeMeshNormalArrayItemSize
* @property {Int} nodeMeshNormalArrayNumItems

* @property {Array} nodeMeshTextureArray
* @property {Int} nodeMeshTextureArrayItemSize
* @property {Int} nodeMeshTextureArrayNumItems

* @property {Array} nodeMeshIndexArray
* @property {Int} nodeMeshIndexArrayItemSize
* @property {Int} nodeMeshIndexArrayNumItems

* @property {Int} [drawElementsMode=4] 0=POINTS, 3=LINE_STRIP, 2=LINE_LOOP, 1=LINES, 5=TRIANGLE_STRIP, 6=TRIANGLE_FAN and 4=TRIANGLES
*/
StormBufferObject = function() {
	this.gl = stormEngineC.stormGLContext.gl;
	
	this.node;
	
	
	// buffers del objeto para opengl
	this.nodeMeshVertexBuffer;
	this.nodeMeshVertexBufferItemSize;
	this.nodeMeshVertexBufferNumItems;

	this.nodeMeshNormalBuffer;
	this.nodeMeshNormalBufferItemSize;
	this.nodeMeshNormalBufferNumItems;
	
	this.nodeMeshTextureBuffer;
	this.nodeMeshTextureBufferItemSize;
	this.nodeMeshTextureBufferNumItems;
	
		this.nodeMeshTextureUnitBuffer;
		this.nodeMeshTextureUnitBufferItemSize;
		this.nodeMeshTextureUnitBufferNumItems;
	
	this.nodeMeshIndexBuffer;
	this.nodeMeshIndexBufferItemSize;
	this.nodeMeshIndexBufferNumItems;
	
	// arrays nativos del objeto
	this.nodeMeshVertexArray;
	this.nodeMeshVertexArrayItemSize;
	this.nodeMeshVertexArrayNumItems;
	this.nodeMeshVertexArrayFrameWSpace;
	
	this.nodeMeshNormalArray = undefined;
	this.nodeMeshNormalArrayItemSize;
	this.nodeMeshNormalArrayNumItems;
	
	this.nodeMeshTextureArray = undefined;
	this.nodeMeshTextureArrayItemSize;
	this.nodeMeshTextureArrayNumItems;
	
		this.nodeMeshTextureUnitArray = undefined;
		this.nodeMeshTextureUnitArrayItemSize;
		this.nodeMeshTextureUnitArrayNumItems;
	
	this.nodeMeshIndexArray = undefined;
	this.nodeMeshIndexArrayItemSize;
	this.nodeMeshIndexArrayNumItems;
	
	// matrix WSpace temporal de este bufferObject. (por cada frame se actualiza)
	this.MPOSFrame = $M16([1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0,0.0,0.0,0.0,0.0,1.0]);
	
	this.drawElementsMode = 4;
};
/**
* @type Void
* @param	{Object} jsonIn
* 	@param {Array|Float32Array} jsonIn.vertexArray Vertices
* 	@param {Array|Float32Array} jsonIn.normalArray Normals
* 	@param {Array|Float32Array} jsonIn.textureArray Texture coords
* 	@param {Array|Float32Array} jsonIn.textureUnitArray Texture unit numbers
* 	@param {Array|Uint16Array} jsonIn.indexArray Indices
*/
StormBufferObject.prototype.attachBuffers = function(stormMeshObject) {
	if(stormMeshObject.vertexArray != undefined) {
		var vertexItemSize = 3, vertexNumItems = stormMeshObject.vertexArray.length/3;
		var vArray = (stormMeshObject.vertexArray instanceof Float32Array) ? stormMeshObject.vertexArray : new Float32Array(stormMeshObject.vertexArray);
		
		this.nodeMeshVertexArray = vArray;// arrays nativos recibidos
		this.nodeMeshVertexArrayItemSize = vertexItemSize;
		this.nodeMeshVertexArrayNumItems = vertexNumItems;
		
		this.nodeMeshVertexBuffer = this.gl.createBuffer();// buffers del objeto para opengl
		this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshVertexBuffer);
		this.gl.bufferData(this.gl.ARRAY_BUFFER, vArray, this.gl.STATIC_DRAW);
		this.nodeMeshVertexBufferItemSize = vertexItemSize;
		this.nodeMeshVertexBufferNumItems = vertexNumItems;
	}
	if(stormMeshObject.normalArray != undefined) {
		var normalItemSize = 3, normalNumItems = stormMeshObject.normalArray.length/3;
		var nArray = (stormMeshObject.normalArray instanceof Float32Array) ? stormMeshObject.normalArray : new Float32Array(stormMeshObject.normalArray);
		
		this.nodeMeshNormalArray = nArray;
		this.nodeMeshNormalArrayItemSize = normalItemSize;
		this.nodeMeshNormalArrayNumItems = normalNumItems;
		
		this.nodeMeshNormalBuffer = this.gl.createBuffer();
		this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshNormalBuffer);
		this.gl.bufferData(this.gl.ARRAY_BUFFER, nArray, this.gl.STATIC_DRAW);
		this.nodeMeshNormalBufferItemSize = normalItemSize;
		this.nodeMeshNormalBufferNumItems = normalNumItems;
	}
	if(stormMeshObject.textureArray != undefined) {
		var textureItemSize = 3, textureNumItems = stormMeshObject.textureArray.length/3;
		var tArray = (stormMeshObject.textureArray instanceof Float32Array) ? stormMeshObject.textureArray : new Float32Array(stormMeshObject.textureArray);
		
		this.nodeMeshTextureArray = tArray;
		this.nodeMeshTextureArrayItemSize = textureItemSize;
		this.nodeMeshTextureArrayNumItems = textureNumItems;
		
		this.nodeMeshTextureBuffer = this.gl.createBuffer();
		this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshTextureBuffer);
		this.gl.bufferData(this.gl.ARRAY_BUFFER, tArray, this.gl.STATIC_DRAW);
		this.nodeMeshTextureBufferItemSize = textureItemSize;
		this.nodeMeshTextureBufferNumItems = textureNumItems;
	}
	if(stormMeshObject.textureUnitArray != undefined) {
		var textureUnitItemSize = 1, textureUnitNumItems = stormMeshObject.textureUnitArray.length;
		var tuArray = (stormMeshObject.textureUnitArray instanceof Float32Array) ? stormMeshObject.textureUnitArray : new Float32Array(stormMeshObject.textureUnitArray);
		
		this.nodeMeshTextureUnitArray = tuArray;
		this.nodeMeshTextureUnitArrayItemSize = textureUnitItemSize;
		this.nodeMeshTextureUnitArrayNumItems = textureUnitNumItems;
		
		this.nodeMeshTextureUnitBuffer = this.gl.createBuffer();
		this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshTextureUnitBuffer);
		this.gl.bufferData(this.gl.ARRAY_BUFFER, tuArray, this.gl.STATIC_DRAW);
		this.nodeMeshTextureUnitBufferItemSize = textureUnitItemSize;
		this.nodeMeshTextureUnitBufferNumItems = textureUnitNumItems;
	}
	if(stormMeshObject.indexArray != undefined) {
		var indexItemSize = 1, indexNumItems = stormMeshObject.indexArray.length;
		var iArray = (stormMeshObject.indexArray instanceof Uint16Array) ? stormMeshObject.indexArray : new Uint16Array(stormMeshObject.indexArray);
		
		this.nodeMeshIndexArray = iArray;
		this.nodeMeshIndexArrayItemSize = indexItemSize;
		this.nodeMeshIndexArrayNumItems = indexNumItems;
	
		this.nodeMeshIndexBuffer = this.gl.createBuffer();
		this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.nodeMeshIndexBuffer);
		this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER, iArray, this.gl.STATIC_DRAW);
		this.nodeMeshIndexBufferItemSize = indexItemSize;
		this.nodeMeshIndexBufferNumItems = indexNumItems;
	}
	
};
/**
* @private
*/
StormBufferObject.prototype.attachBuffersSeparateXYZ = function(arrX,arrY,arrZ) {
	// PACK 1FLOAT (0.0-1.0) TO 4FLOAT RGBA (0.0-1.0, 0.0-1.0, 0.0-1.0, 0.0-1.0)
	var arrayX = new Uint8Array(arrX.length*4); 
	var arrayY = new Uint8Array(arrY.length*4); 
	var arrayZ = new Uint8Array(arrZ.length*4); 
	for(var n = 0, f = arrX.length; n &lt; f; n++) {  
		var idd = n*4;
		var arrPack;
		arrPack = stormEngineC.utils.pack((arrX[n]+1000.0)/2000.0);
		arrayX[idd+0] = arrPack[0]*256;
		arrayX[idd+1] = arrPack[1]*256;
		arrayX[idd+2] = arrPack[2]*256;
		arrayX[idd+3] = arrPack[3]*256;
		arrPack = stormEngineC.utils.pack((arrY[n]+1000.0)/2000.0);
		arrayY[idd+0] = arrPack[0]*256;
		arrayY[idd+1] = arrPack[1]*256;
		arrayY[idd+2] = arrPack[2]*256;
		arrayY[idd+3] = arrPack[3]*256;
		arrPack = stormEngineC.utils.pack((arrZ[n]+1000.0)/2000.0);
		arrayZ[idd+0] = arrPack[0]*256;
		arrayZ[idd+1] = arrPack[1]*256;
		arrayZ[idd+2] = arrPack[2]*256;
		arrayZ[idd+3] = arrPack[3]*256;
	}
	// X
	this.nodeMeshVertexArrayX = new Uint8Array(arrX);// arrays nativos recibidos
	
	this.nodeMeshVertexBufferX = this.gl.createBuffer();// buffers del objeto para opengl
	this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshVertexBufferX);
	this.gl.bufferData(this.gl.ARRAY_BUFFER, new Uint8Array(arrayX), this.gl.DYNAMIC_DRAW);
	// Y
	this.nodeMeshVertexArrayY = new Uint8Array(arrY);// arrays nativos recibidos
	
	this.nodeMeshVertexBufferY = this.gl.createBuffer();// buffers del objeto para opengl
	this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshVertexBufferY);
	this.gl.bufferData(this.gl.ARRAY_BUFFER, new Uint8Array(arrayY), this.gl.DYNAMIC_DRAW);
	// Z
	this.nodeMeshVertexArrayZ = new Uint8Array(arrZ);// arrays nativos recibidos
	
	this.nodeMeshVertexBufferZ = this.gl.createBuffer();// buffers del objeto para opengl
	this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.nodeMeshVertexBufferZ); 
	this.gl.bufferData(this.gl.ARRAY_BUFFER, new Uint8Array(arrayZ), this.gl.DYNAMIC_DRAW);
	
};
/**
* Extrude all triangles of this buffer
* @type Void
* @param	{Object} jsonIn
* 	@param {StormV3} [jsonIn.direction=$V3([0.0,1.0,0.0])] Direction vector
* 	@param {Float} [jsonIn.dim=0.5] Length of extrusion
* 	@param {Float} [jsonIn.bevel] Length of bevel
* 	@param {Float} [jsonIn.bevelAngle] Angle of bevel
*/
StormBufferObject.prototype.extrude = function(jsonIn) {
	var jIn = {	direction:(jsonIn == undefined || jsonIn.direction == undefined)?undefined:jsonIn.direction,
				dim:(jsonIn == undefined || jsonIn.dim == undefined)?undefined:jsonIn.dim,
				bevel:(jsonIn == undefined || jsonIn.bevel == undefined)?undefined:jsonIn.bevel,
				bevelAngle:(jsonIn == undefined || jsonIn.bevelAngle == undefined)?undefined:jsonIn.bevelAngle};

	var arr = [];
	for(var nB = 0, fB = this.nodeMeshVertexArray.length/9; nB &lt; fB; nB++) {
		var id = nB*9;
		arr.push(	[$V3([this.nodeMeshVertexArray[id],this.nodeMeshVertexArray[id+1],this.nodeMeshVertexArray[id+2]]),
					$V3([this.nodeMeshVertexArray[id+3],this.nodeMeshVertexArray[id+4],this.nodeMeshVertexArray[id+5]]),
					$V3([this.nodeMeshVertexArray[id+6],this.nodeMeshVertexArray[id+7],this.nodeMeshVertexArray[id+8]])]);
	}
	this.node.extrude({	arrayV:arr,
						direction:jIn.direction,
						dim:jIn.dim,
						bevel:jIn.bevel,
						bevelAngle:jIn.bevelAngle});

};</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					StormEngineC 1.2 API DOC
					<br />
					
					
		<span class="copyright">
		2010 Roberto Gonzalez. http://stormcolour.appspot.com
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha2</a>
		on Sun Sep 20 2015 23:11:10 GMT+0200 (CEST) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	
	<script>
		$( function () {
			$('#main').localScroll({
				offset: { top: 56 } //offset by the height of your header (give or take a few px, see what works for you)
			});
			$( "dt h4.name" ).each( function () {
				var $this = $( this );
				var icon = $( "<i/>" ).addClass( "icon-plus-sign" ).addClass( "pull-right" ).addClass( "icon-white" );
				var dt = $this.parents( "dt" );
				var children = dt.next( "dd" );

				$this.append( icon ).css( {cursor : "pointer"} );
				$this.addClass( "member-collapsed" ).addClass( "member" );

				children.hide();
				$this.toggle( function () {
					icon.addClass( "icon-minus-sign" ).removeClass( "icon-plus-sign" ).removeClass( "icon-white" );
					$this.addClass( "member-open" ).removeClass( "member-collapsed" );
					children.slideDown();
				}, function () {
					icon.addClass( "icon-plus-sign" ).removeClass( "icon-minus-sign" ).addClass( "icon-white" );
					$this.addClass( "member-collapsed" ).removeClass( "member-open" );
					children.slideUp();
				} );
			} );
		} );
	</script>
	

</body>
</html>
